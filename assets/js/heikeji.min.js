/*!
 * bilibili_hkj v0.2.7 (http://keyfunc.github.io/bilibili_hkj)
 * Copyright 2012-2014 Key Dai
 * Licensed under MIT (http://github.com/keyfunc/bilibili_hkj/blob/master/LICENSE)
 */
(function(){var __slice=[].slice;!function(d,w){var blhkj_main,callouts,current_version,head,i,jQueryVersion,loadjQuery,messageExpires,normalModel,style,tpModel,v,version,_$,_b_url_r,_bilibili_url,_i,_len,_params,_v;if(this._c_tip=function(){var a,b,c,e,f,g,h;for(b=arguments[0],e=2<=arguments.length?__slice.call(arguments,1):[],a=d.createElement("div"),a.className="tip",f=0,g=e.length;g>f;f++)c=e[f],h=d.createElement("p"),h.innerHTML=c,a.appendChild(h);return b.appendChild(a),__hidden(a,5e3)},this._c_message=function(){var a,b,c,e,f,g,h,i,j,k,l;for(b=arguments[0],f=arguments[1],g=arguments[2],e=4<=arguments.length?__slice.call(arguments,3):[],a=d.createElement("div"),a.className="message",i=d.createElement("h4"),h=d.createElement("a"),h.innerHTML=f,h.href=g,h.target="_blank",i.appendChild(h),a.appendChild(i),j=0,k=e.length;k>j;j++)c=e[j],l=d.createElement("p"),l.innerHTML=c,a.appendChild(l);return b.appendChild(a),__hidden(a,2e4)},this.__hidden=function(a,b){return setTimeout(function(){var b,c;return b=1,c=setInterval(function(){return b-=.01,a.style.opacity=b,0>b?(w.clearInterval(c),a.parentNode.removeChild(a)):void 0},20)},b)},_params=/http:\/\/(www\.bilibili\.com|www\.bilibili\.tv|bilibili\.kankanews\.com)?\/video\/av([0-9]+)\/(?:index_([0-9]+)\.html)?/.exec(d.URL),_b_url_r=/http:\/\/(www\.bilibili\.com|www\.bilibili\.tv|bilibili\.kankanews\.com)/.exec(d.URL),tpModel=!_params&&!!_b_url_r,_bilibili_url=_b_url_r?_b_url_r[0]:null,head=d.getElementsByTagName("head")[0],style=d.createElement("style"),style.type="text/css",style.appendChild(d.createTextNode('#_callouts {\n  position: fixed;\n  right: 16px;\n  bottom: 32px;\n  z-index: 100;\n}\n#_callouts div {\n  position: relative;\n  margin: 10px 0;\n  padding: 7px 15px 7px 12px;\n  text-align:left;\n  border-left:5px solid #eee;\n  font: 13px/1.65 "Segoe UI", "Helvetica Neue", Helvetica, Arial, "Hiragino Kaku Gothic Pro", "Meiryo", "Hiragino Sans GB", "Microsoft YaHei", "STHeiti", "SimSun", Sans-serif;\n  z-index: 100;\n}\n#_callouts div p,\n#_callouts div h4 {\n  margin: 0;\n}\n#_callouts div.message {\n  background-color: #fdf7f7;\n  border-color: #d9534f;\n}\n#_callouts div.message h4,\n#_callouts div.message h4 * {\n  color: #d9534f;\n  text-decoration: none;\n}\n#_callouts div.tip {\n  background-color: #f4f8fa;\n  border-color: #5bc0de;\n}')),head.appendChild(style),callouts=d.createElement("div"),callouts.id="_callouts",d.body.appendChild(callouts),!_params&&!tpModel)return void(w.bilibili_hkj=function(){return _c_tip(callouts,"\u75f4\u841d\u8389, \u7231\u8150\u5973","\u63a7\u9501\u9aa8, \u604b\u767e\u5408")})();if(messageExpires=new Date("2014/08/23").getTime()+1296e6,(new Date).getTime()-messageExpires<0&&_c_message(callouts,"\u4fee\u590d\u4e862P\u6a21\u5f0f\u5931\u6548\u7684\u95ee\u9898","http://keyfunc.github.io/bilibili_hkj/","\u4fee\u590d\u201c\u7528\u624b\u673a\u770b\u201d\u65e0\u6cd5\u6b63\u5e38\u663e\u793a\u95ee\u9898"),jQueryVersion="1.11.1",this.Loader={importJS:function(a,b,c){var e;return e=d.createElement("script"),e.type="text/javascript",e.onload=function(){return console.log("onLoad: "+a),void 0!==c?c():void 0},e.src=a,b.appendChild(e)}},loadjQuery=!0,void 0!==w.jQuery)for(version=jQueryVersion.split("."),current_version=$.fn.jquery.split("."),i=_i=0,_len=current_version.length;_len>_i;i=++_i){if(v=current_version[i],v=parseInt(v),_v=parseInt(version[i]),_v>v){_$=jQuery.noConflict(),console.log("jQuery version: "+_$.fn.jquery+" --> "+jQueryVersion),loadjQuery=!0;break}if(v>_v){loadjQuery=!1;break}loadjQuery=!1}return normalModel=function(a){var b,c,e,f;b="http://api.bilibili.com/view?type=json&appkey=12737ff7776f1ade&id="+a[2]+(void 0!==a[3]?"&page="+a[3]:""),f="http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20json%20where%20url=%22"+encodeURIComponent(b)+"%22&format=json&callback=cbfunc",c=d.getElementById("bofqi"),c.innerHTML="",_c_tip(callouts,"\u6210\u529f\u5e72\u6389\u539f\u5148\u7684\u64ad\u653e\u5668"),e=d.createElement("script"),e.setAttribute("src",f),e.onload=function(){return this.parentNode.removeChild(this),e=null},head.appendChild(e),(w.bilibili_hkj=function(){return _c_tip(callouts,"\u6b63\u5728\u83b7\u53d6\u795e\u79d8\u4ee3\u7801")})()},blhkj_main=function(){return tpModel?($("a[href*='/video/av']").click(function(a){var b,c;return a.preventDefault(),_params=/(\/video|video)\/av([0-9]+)?/.exec($(this).attr("href")),c=$(this).text(),$(".z").remove(),b=$('<div class="z"></div>'),$(".header").after(b),b.load(_bilibili_url+"/video/av877489/ .z:first",function(){return $(".cover_image",b).hide(),$(".tminfo span[typeof='v:Breadcrumb']",b).remove(),$(".tminfo time",b).remove(),$("\uff03assdown",b).attr("href",$("\uff03assdown",b).attr("href").replace("877489",_params[2])),$(".info .sf a:last",b).attr("href",$(".info .sf a:last",b).attr("href").replace("877489",_params[2])),$(".info .sf a:last",b).attr("onclick",$(".info .sf a:last",b).attr("onclick").replace("877489",_params[2])),$(".ad-f",b).remove(),$(".ad-e1",b).remove(),$(".ad-e2",b).remove(),$(".ad-e3",b).remove(),$(".ad-e4",b).remove(),$(".info h2",b).text("").attr("title",""),$(".intro",b).text(""),$(".common .comm img",b).attr("onclick",$(".common .comm img",b).attr("onclick").replace("877489",_params[2])),$("#newtag a",b).attr("onclick",$("#newtag a",b).attr("onclick").replace("877489",_params[2])),$("#recommend_frmPost input[name='aid']",b).val(_params[2]),void 0!==w.history.pushState&&w.history.pushState(null,c,_bilibili_url+"/video/av"+_params[2]),Loader.importJS("http://static.hdslb.com/js/page.arc.js",head),Loader.importJS("http://static.hdslb.com/js/jquery.qrcode.min.js",head),Loader.importJS("http://interface.bilibili.cn/count?aid="+_params[2],head),normalModel(_params)})}),$(w).on("popstate",function(){return w.location.replace(d.location)}),(w.bilibili_hkj=function(){return _c_tip(callouts,"2P\u6a21\u5f0f\u521d\u59cb\u5316\u5b8c\u6210","\uff3c(\u30fb\u03c9\u30fb\uff3c)\u4e27\u5c38\uff01(\uff0f\u30fb\u03c9\u30fb)\uff0fbishi")})(),void 0):d.getElementById("bofqi_embed")||function(){var a,b,c;b=d.getElementsByTagName("iframe"),a=/https:\/\/secure\.bilibili\.com\/secure,cid=([0-9]+)(?:&aid=([0-9]+))?/;for(c in b)if(a.exec(b[c].src))return!0;return!1}()?void(w.bilibili_hkj=function(){return _c_tip(callouts,"bilibili\u6ee1\u72b6\u6001\u4e2d","\uff3c(\u30fb\u03c9\u30fb\uff3c)\u4e27\u5c38\uff01(\uff0f\u30fb\u03c9\u30fb)\uff0fbishi")})():normalModel(_params)},this.cbfunc=function(){var iframe,info,onMessage;return info=arguments[0].query.results.json,void 0!==info.cid?(_c_tip(callouts,"\u83b7\u53d6\u795e\u79d8\u4ee3\u7801\u6210\u529f","\u795e\u79d8\u4ee3\u7801ID: "+info.cid),tpModel&&($(".info h2").text(info.title).attr("title",info.title),$(".intro").text(info.description),this.mid=info.mid,kwtags(info.tag.split(","),"")),iframe=d.createElement("iframe"),iframe.height=482,iframe.width=950,iframe.src="https://secure.bilibili.com/secure,cid="+info.cid+"&amp;aid="+_params[2],iframe.setAttribute("class","player"),iframe.setAttribute("border",0),iframe.setAttribute("scrolling","no"),iframe.setAttribute("frameborder","no"),iframe.setAttribute("framespacing",0),bofqi.appendChild(iframe),w.postMessage?(onMessage=function(e){return"https://secure.bilibili.com"===e.origin&&"secJS:"===e.data.substr(0,6)?eval(e.data.substr(6)):void 0},w.addEventListener?w.addEventListener("message",onMessage,!1):w.attachEvent&&w.attachEvent("onmessage",onMessage)):setInterval(function(){var evalCode;return(evalCode=__GetCookie("__secureJS"))?(__SetCookie("__secureJS",""),eval(evalCode)):void 0},1e3),(w.bilibili_hkj=function(){return _c_tip(callouts,"Mission Completed","\u55f6\u54e9\u55f6\u54e9 - ( \u309c- \u309c)\u3064\u30ed  \u4e7e\u676f~")})()):(_c_tip(callouts,"\u975e\u5e38\u62b1\u6b49, bishi\u59e5\u7237\u4e0d\u80af\u7ed9\u795e\u79d8\u4ee3\u7801",'\u8981\u4e0d\u4f60\u543c\u4e00\u58f0"\u5175\u5e93\u5317"\u540e\u518d\u8bd5\u8bd5?'),w.bilibili_hkj=null)},loadjQuery?Loader.importJS("http://keyfunc.github.io/bilibili_hkj/assets/js/jquery-"+jQueryVersion+".min.js",head,blhkj_main):blhkj_main()}(document,window)}).call(this);
//# sourceMappingURL=heikeji.min.map